var SV=window.SV||{};SV.AdvancedBBCode=SV.AdvancedBBCode||{};SV.$=SV.$||window.jQuery||null;
(function(f,g,h){const e=SV.$,d="function"!==typeof XF.on;SV.AdvancedBBCode.TransparentAsSpoiler=XF.Element.newHandler({options:{storageContainer:"toggleTransparencyToSpoiler",storageKey:"toggle"},colorSpans:null,initSpoiler:!1,init(){var a=this.target||this.$target.get(0),b=this.findMessageBody(a);if(b&&(this.colorSpans=this.findSpans(b),0!==this.colorSpans.length)){b=XF.ToggleStorageData.get(this.options.storageContainer,this.options.storageKey);const c=a.querySelector(d?'i[data-icon-type="hidden"]':
'i:has(svg[data-icon-type="hidden"])');a=a.querySelector(d?'i[data-icon-type="shown"]':'i:has(svg[data-icon-type="shown"])');d||(c.querySelector("svg").style.display="",a.querySelector("svg").style.display="");b?(c.style.display="",a.style.display="none"):(c.style.display="none",a.style.display="");d?(e(c).on("click",this.click.bind(this)),e(a).on("click",this.click.bind(this))):(XF.on(c,"click",this.click.bind(this)),XF.on(a,"click",this.click.bind(this)));b&&this.showSpoiler()}},findMessageBody(a){return(a=
a.closest(".message-main"))?a.querySelector(".message-userContent .message-body"):null},findSpans(a){const b=a.style.backgroundColor;return Array.from(a.querySelectorAll(".fixed-color")).filter(c=>{c=c.style.color;return"transparent"===c?!0:c==b})},showSpoiler(){this.colorSpans.forEach(a=>{a.classList.add("bbc-spoiler","bbc-spoiler-instant");a.dataset.class="bbc-spoiler";a.dataset.xfClick="toggle-class";a.setAttribute("tabindex",0);a.setAttribute("data-xf-click","toggle-class")})},hideSpoiler(){this.colorSpans.forEach(a=>
{a.classList.remove("bbc-spoiler","bbc-spoiler-instant");delete a.dataset.class;delete a.dataset.xfClick;a.removeAttribute("tabindex");a.removeAttribute("data-xf-click")})},click(a){if(0!==this.colorSpans.length){var b=this.target||this.$target.get(0),c=b.querySelector(d?'i[data-icon-type="hidden"]':'i:has(svg[data-icon-type="hidden"])');b=b.querySelector(d?'i[data-icon-type="shown"]':'i:has(svg[data-icon-type="shown"])');(a=a.currentTarget===b)?(c.style.display="",b.style.display="none"):(c.style.display=
"none",b.style.display="");a?(XF.ToggleStorageData.set(this.options.storageContainer,this.options.storageKey,1,2592E3),this.showSpoiler()):(XF.ToggleStorageData.remove(this.options.storageContainer,this.options.storageKey),this.hideSpoiler())}}});XF.Element.register("sv-transparent-as-spoiler","SV.AdvancedBBCode.TransparentAsSpoiler")})(window,document);
